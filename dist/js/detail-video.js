"use strict";function isIOS(e){return e.indexOf("iPhone")>0}function renderData(e){var a=e;cacheData=a,voteId=a.voteId;var t=a.content?a.content:"",i=$(window).width(),s=i*defaultHeight/defaultWidth,n=window.navigator.userAgent,o="";1==a.videoType&&(o='<header><div class="player clearfix" style="height:'+s+'px;">'+t,isIOS(n)||(o+='<button class="video-button" style="top: '+(s-40)+'px"></button>'),o+="</div></header>"),o+='<div class="content">',o+='<div class="video-header">',o+='<h1 class="title">'+a.title+"</h1>",o+='<div class="video-meta clearfix">',a.views&&(o+='<span class="date"><em class="play-num"></em>播放: '+a.views+" 次</span>"),o+='<span class="author ml5">'+a.author+"</span>",o+="</div>",a.excerpt&&(o+='<div class="excerpt">'+a.excerpt+"</div>"),o+="</div>";var l={};try{l=Jnapp.jn_login_info()}catch(c){}"string"==typeof l&&(l=$.parseJSON(l)),o+='<div class="video-question" style="display:block;"></div>',o+='<div class="video-question-answer" style="display:none;"></div>',voteId&&"undefined"!==voteId&&$.getJSON("http://api.15w.com/client/app/jn/v1_4/vote/detail?dataId="+voteId+"&callback=?",function(e){if("10000"==e.code){var a=e.data,t=a.votes,i=a.excerpt,s=a.results,n=$(".video-question"),o=$(".video-question-answer"),c='<p class="video-question-title">'+a.title+"</p>";c+='<a class="video-question-option" data-id="0" href="##"><span>A:</span>'+t.A+"</a>",c+='<a class="video-question-option" data-id="1" href="##"><span>B:</span>'+t.B+"</a>",c+='<a class="video-question-option" data-id="2" href="##"><span>C:</span>'+t.C+"</a>",c+='<a class="video-question-option" data-id="3" href="##"><span>D:</span>'+t.D+"</a>",c+="<p>"+i+"</p>";var d='<ul class="video-answer"><li class="video-answer-title">'+a.title+'</li><li class="video-answer-option"><span>A:</span>'+t.A+'<em style="display: none" data-id="0">(已选择)</em></li><ul class="option-detail"><li class="color-a"></li><li class="option-num">'+s.A+'</li></ul><li class="video-answer-option" ><span>B:</span>'+t.B+'<em style="display: none" data-id="1">(已选择)</em></li><ul class="option-detail"><li class="color-b"></li><li class="option-num">'+s.B+'</li></ul><li class="video-answer-option clearfix" ><span>C:</span>'+t.C+'<em style="display: none" data-id="2">(已选择)</em></li><ul class="option-detail"><li class="color-c"></li><li class="option-num">'+s.C+'</li></ul><li class="video-answer-option" ><span>D:</span>'+t.D+'<em style="display: none" data-id="3">(已选择)</em></li><ul class="option-detail"><li class="color-d"></li><li class="option-num">'+s.D+"</li></ul></ul><p>"+i+"</p>";if(n.html(c),o.html(d),l.userid&&l.token)try{var p=Jnapp.jn_getData(l.userid+"_"+voteId);p&&(n.hide(),o.show())}catch(r){}}});try{var d=Jnapp.jn_getShare();"string"==typeof d&&(d=$.parseJSON(d),o+='<div class="excerpt-share"><div class="video-excerpt"><div class="video-excerpt-tip"><img src="data:image/png;charset=utf-8;base64,'+d.baseIcon+'" alt="loading..."/><p>'+d.title+"</p></div></div>")}catch(c){o+='<div class="excerpt-share"><div class="video-excerpt"><div class="video-excerpt-tip"><img src="../images/timo_2xpng" alt="loading..."/><p>测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试测试</p></div></div>'}o+='<div class="maintext-share"><a href="" class="maintext-share-weixin"><img src="images/news_btn_weixin_nor.png" /><p class="sharename">微信</p></a><a href="" class="maintext-share-frident"><img src="images/news_btn_pyq_nor.png" /><p class="sharename">朋友圈</p></a><a href="" class="maintext-share-weibo"><img src="images/news_btn_weibo_nor.png" /><p class="sharename">微博</p></a><a href="" class="maintext-share-qq-space"><img src="images/空间_2x.png" /><p class="sharename">空间</p></a><a href="" class="maintext-share-qq"><img src="images/QQ_2x.png" /><p class="sharename">QQ</p></a></div></div>',a.recomendVideos.length>0&&(o+='<section class="list"><h3>视频推荐</h3><ul> ',$.each(a.recomendVideos,function(e,a){o+='<li class="clearFix"><a href="##" class="list-item"  data-type="'+a.articleType+'" data-id="'+a.extra+'"><img class="fl" src="'+a.thumbnail+'"/>',o+='<p class="list-title">'+a.title+"</p> ",a.tagColor&&a.tagName&&(o+='<span class="list-tag" style="color:'+a.tagColor+";border-color:"+a.tagColor+';">'+a.tagName+"</span>");var t,i=new Date;a.updateTime&&(i=new Date(1e3*a.updateTime)),t=i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate(),o+='<span class="list-time">'+t+"</span>",o+="</a></li>"}),o+='</ul></section><section class="line"></section></div>'),$("#detail").html(o),1==a.videoType&&$("iframe").css({height:s+"px"});try{Jnapp.jn_setHorizontal(!1)}catch(c){}}window.Jn={};var cacheData=null,voteId,defaultHeight=360,defaultWidth=640;Jn.setData=function(e){"videoInitDetail"==e.key&&renderData(e.content)},$(function(){function e(e){try{var a=cacheData.thumbnail,t=cacheData.title,i=cacheData.excerpt,s=cacheData.shareUrl;Jnapp.jn_share(e,a,t,i,s)}catch(n){}}$.get("data/video-detail.json",function(e){renderData(e.content)}),$(document).on("click",".list-item",function(e){e.preventDefault();try{Jnapp.jn_related($(this).data("type"),$(this).data("id")+"")}catch(a){}}),$(document).on("click",".maintext-share-weibo",function(a){a.preventDefault(),e(0)}),$(document).on("click",".maintext-share-weixin",function(a){a.preventDefault(),e(1)}),$(document).on("click",".maintext-share-frident",function(a){a.preventDefault(),e(2)}),$(document).on("click",".maintext-share-qq-space",function(a){a.preventDefault(),e(3)}),$(document).on("click",".maintext-share-qq",function(a){a.preventDefault(),e(4)});var a=!1,t=$(".player"),i=$(window).width(),s=i*defaultHeight/defaultWidth,n=$(".video-recommend .content");$(document).on("click",".video-button",function(e){e.preventDefault();try{a=!a;var o=$(".player iframe");a?(o.css("height","100%"),t.css("height",i+"px"),n.css("display","none"),$(".video-button").css("top",i-40+"px"),$("body").css({height:"100%",overflow:"hidden"}),Jnapp.jn_setHorizontal(!0)):(o=$("header .player iframe"),o.css("height",s+"px"),t.css("height",s+"px"),$("body").css({height:"auto",overflow:"hidden"}),$(".video-button").css("top",s-40+"px"),Jnapp.jn_setHorizontal(!1))}catch(e){}}),$(document).on("click",".video-question-option",function(e){e.preventDefault();var a=$(this).text(),t=$(".video-question"),i=$(".video-question-answer"),s=$(this).data("id"),n=$(".video-answer-option").children("[data-id='"+s+"']"),o=$(this).text().substr(0,1);try{var l=Jnapp.jn_login_info();"string"==typeof l&&(l=$.parseJSON(l));var c=l.userid,d=l.token;if(c&&d){var p={dataId:voteId,uid:c,token:d,sign:o};$.post("http://api.15w.com/client/app/jn/v1_4/vote/vote",p);try{Jnapp.jn_setData(c+"_"+voteId,o),t.hide(),i.show(),n.show(),Jnapp.jn_comment(cacheData.content.changyanSid,"我选 "+a+", 求中奖")}catch(r){}}else Jnapp.jn_login()}catch(r){}})});