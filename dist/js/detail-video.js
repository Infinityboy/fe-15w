"use strict";function isIOS(e){return e.indexOf("iPhone")>0}function renderData(e){var a=e;cacheData=a,voteId=a.voteId;var s=a.content?a.content:"",t=$(window).width(),n=t*defaultHeight/defaultWidth,i=(window.navigator.userAgent,"");1==a.videoType&&(i='<header style="height:'+n+'px;position: fixed;overflow: hidden;width: 100%"><div class="player clearfix">'+s,i+='<button class="video-button" style="top: '+(n-40)+'px"></button>',i+="</div></header>"),i+='<div class="content" style="padding-top: '+n+'px">',i+='<div class="video-header">',i+='<h1 class="title">'+a.title+"</h1>",i+='<div class="video-meta clearfix">',a.views&&(i+='<span class="date"><em class="play-num"></em>'+a.views+"</span>"),i+='<span class="author ml5">'+a.author+"</span>",i+="</div>",a.excerpt&&(i+='<div class="excerpt">'+a.excerpt+"</div>"),i+="</div>";var o={};try{o=Jnapp.jn_login_info()}catch(l){}"string"==typeof o&&(o=$.parseJSON(o)),i+='<div class="video-question""></div>',voteId&&"undefined"!==voteId&&$.getJSON("http://api.15w.com/client/app/jn/v1_4/vote/detail?dataId="+voteId+"&callback=?",function(e){if("10000"==e.code){var a=e.data,s=a.votes,t=a.excerpt,n=a.results,i=$(".video-question"),l=null;if(o.userid&&o.token)try{l=Jnapp.jn_getData(o.userid+"_"+voteId)}catch(c){}var d=[n.A,n.B,n.C,n.D],p=Math.max.apply(null,d),r=Math.max(1,d[0]/p*80),h=Math.max(1,d[1]/p*80),m=Math.max(1,d[2]/p*80),v=Math.max(1,d[3]/p*80),u='<p class="video-question-title">'+a.title+"</p>";l?(isVote=!0,u+='<a class="video-question-option" style="border: none"  data-id="0" data-elem="A" href="##"><span>A:</span><span class="val">'+s.A+'</span> <span class="selected" style="display: none">(已选择)</span><div class="progress-bar"><em class="progress color-a"  style="width:'+r+'%"></em><em class="num">'+n.A+"</em></div></a>",u+='<a class="video-question-option" style="border: none"  data-id="1" data-elem="B" href="##"><span>B:</span><span class="val">'+s.B+'</span> <span class="selected" style="display: none">(已选择)</span><div class="progress-bar"><em class="progress color-b"  style="width:'+h+'%"></em><em class="num">'+n.B+"</em></div></a>",u+='<a class="video-question-option" style="border: none"  data-id="2" data-elem="C" href="##"><span>C:</span><span class="val">'+s.C+'</span> <span class="selected" style="display: none">(已选择)</span><div class="progress-bar"><em class="progress color-c"  style="width:'+m+'%"></em><em class="num">'+n.C+"</em></div></a>",u+='<a class="video-question-option" style="border: none"  data-id="3" data-elem="D"  href="##"><span>D:</span><span class="val">'+s.D+'</span> <span class="selected"  style="display: none">(已选择)</span><div class="progress-bar"><em class="progress color-d"  style="width:'+v+'%"></em><em class="num">'+n.D+"</em></div></a>",u+="<p>"+t+"</p>"):(u+='<a class="video-question-option" data-id="0"  data-elem="A"  href="##"><span>A:</span><span class="val">'+s.A+'</span> <span class="selected" style="display: none">(已选择)</span><div class="progress-bar" style="display: none"><em class="progress color-a"  style="width:'+r+'%"></em><em class="num">'+n.A+"</em></div></a>",u+='<a class="video-question-option" data-id="1"  data-elem="B" href="##"><span>B:</span><span class="val">'+s.B+'</span> <span class="selected" style="display: none">(已选择)</span><div class="progress-bar" style="display: none"><em class="progress color-b"  style="width:'+h+'%"></em><em class="num">'+n.B+"</em></div></a>",u+='<a class="video-question-option" data-id="2"  data-elem="C"  href="##"><span>C:</span><span class="val">'+s.C+'</span> <span class="selected" style="display: none">(已选择)</span><div class="progress-bar" style="display: none"><em class="progress color-c"  style="width:'+m+'%"></em><em class="num">'+n.C+"</em></div></a>",u+='<a class="video-question-option" data-id="3"  data-elem="D" href="##"><span>D:</span><span class="val">'+s.D+'</span> <span class="selected" style="display: none">(已选择)</span><div class="progress-bar" style="display: none"><em class="progress color-d"  style="width:'+v+'%"></em><em class="num">'+n.D+"</em></div></a>",u+="<p>"+t+"</p>"),i.html(u)}});try{var c=Jnapp.jn_getShare();"string"==typeof c&&(c=$.parseJSON(c),i+='<div class="excerpt-share"><div class="video-excerpt"><div class="video-excerpt-tip"><img src="data:image/jpeg;charset=utf-8;base64,'+c.baseIcon+'" alt="loading..."/><p>'+c.title+"</p></div></div>")}catch(l){}i+='<div class="maintext-share"><a href="" class="maintext-share-weixin"><img src="images/news_btn_weixin_nor.png" /><p class="sharename">微信</p></a><a href="" class="maintext-share-frident"><img src="images/news_btn_pyq_nor.png" /><p class="sharename">朋友圈</p></a><a href="" class="maintext-share-weibo"><img src="images/news_btn_weibo_nor.png" /><p class="sharename">微博</p></a><a href="" class="maintext-share-qq"><img src="images/qq_zone.png" /><p class="sharename">空间</p></a><a href="" class="maintext-share-qq-space"><img src="images/QQ_2x.png" /><p class="sharename">QQ</p></a></div></div>',a.recomendVideos.length>0&&(i+='<section class="list"><h3>视频推荐</h3><ul> ',$.each(a.recomendVideos,function(e,a){i+='<li class="clearFix"><a href="##" class="list-item"  data-type="'+a.articleType+'" data-id="'+a.extra+'"><img class="fl" src="'+a.thumbnail+'"/>',i+='<p class="list-title">'+a.title+"</p> ",a.tagColor&&a.tagName&&(i+='<span class="list-tag" style="color:'+a.tagColor+";border-color:"+a.tagColor+';">'+a.tagName+"</span>");var s,t=new Date;a.updateTime&&(t=new Date(1e3*a.updateTime)),s=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate(),i+='<span class="list-time">'+s+"</span>",i+="</a></li>"}),i+='</ul></section><section class="line"></section></div>'),$("#detail").html(i),1==a.videoType&&$("iframe").css({height:n+"px"})}window.Jn={};var cacheData=null,voteId,defaultHeight=360,defaultWidth=640,isVote=!1;Jn.setData=function(e){"videoInitDetail"==e.key&&renderData(e.content)},$(function(){function e(e){try{var a=cacheData.thumbnail,s=cacheData.title,t=cacheData.excerpt,n=cacheData.shareUrl;Jnapp.jn_share(e,a,s,t,n)}catch(i){}}function a(){var e=[];$.each($(".num"),function(a,s){e.push(parseInt($(s).text()))});var a=Math.max.apply(null,e),s=[];s.push(Math.max(1,e[0]/a*80)),s.push(Math.max(1,e[1]/a*80)),s.push(Math.max(1,e[2]/a*80)),s.push(Math.max(1,e[3]/a*80));var t=$(".progress");$.each(t,function(e,a){$(a).css("width",s[e]+"%")})}$(document).on("click",".list-item",function(e){e.preventDefault();try{Jnapp.jn_related($(this).data("type"),$(this).data("id")+"")}catch(a){}}),$(document).on("click",".maintext-share-weibo",function(a){a.preventDefault(),e(0)}),$(document).on("click",".maintext-share-weixin",function(a){a.preventDefault(),e(1)}),$(document).on("click",".maintext-share-frident",function(a){a.preventDefault(),e(2)}),$(document).on("click",".maintext-share-qq-space",function(a){a.preventDefault(),e(3)}),$(document).on("click",".maintext-share-qq",function(a){a.preventDefault(),e(4)});var s=!1,t=$(".player"),n=$(window).width(),i=n*defaultHeight/defaultWidth,o=$(".video-recommend .content");$(document).on("click",".video-button",function(e){e.preventDefault();try{s=!s;var a=$(".player iframe");s?(a.css("height","100%"),t.css("height",n+"px"),o.css("display","none"),$(".video-button").css("top",n-40+"px"),$("body").css({height:"100%",overflow:"hidden"}),window.alert("top:"+(n-40)),Jnapp.jn_setHorizontal(!0)):(a=$("header .player iframe"),a.css("height",i+"px"),t.css("height",i+"px"),$("body").css({height:"auto",overflow:"hidden"}),$(".video-button").css("top",i-40+"px"),window.alert("top:"+(i-40)),Jnapp.jn_setHorizontal(!1))}catch(e){}}),$(document).on("click",".video-question-option",function(e){if(e.preventDefault(),!isVote){var s=($(this).text(),$(".video-question")),t=$(this).data("id"),n=($(".video-answer-option").children("[data-id='"+t+"']"),parseInt($(this).find(".num").text())),i=$(this).data("elem"),o=$(this).find("span.val").text();try{var l=Jnapp.jn_login_info();"string"==typeof l&&(l=$.parseJSON(l));var c=l.userid,d=l.token;if(c&&d){var p={dataId:voteId,uid:c,token:d,sign:i};$(this).find(".num").text(n+1),a(),s.find(".video-question-option").css("border-color","transparent"),s.find(".progress-bar").show(),$(this).find(".selected").show(),isVote=!0,$.post("http://api.15w.com/client/app/jn/v1_4/vote/vote",p,function(e){if("10000"==e.code)try{Jnapp.jn_comment(cacheData.changyanSid,"我选 "+i+" : "+o+", 求中奖")}catch(a){window.alert(e.code)}else window.alert(e.code)})}else Jnapp.jn_login()}catch(r){window.alert("请下载电竞头条客户端经行投票!")}}})});